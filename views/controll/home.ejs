<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/css/base.css" />
    <link rel="stylesheet" href="/css/display.css" />
    <link rel="stylesheet" href="/css/homepage.css" />
    <!-- <script src="./controll.js"></script> -->
    <title>Document</title>
  </head>

  <body class="flex jC-center aI-center fD-column">
    <script>
      window.WebSocket = window.WebSocket;
      var connection = new WebSocket("ws://anlozrer.duckdns.org:33000/");
      connection.onopen = function () {};
      connection.onerror = function (error) {};
      connection.onmessage = function (msg) {
        if (msg.data == "CUA DANG DONG" || msg.data == "CUA DANG MO") {
          document.getElementById("statedoor").innerText = msg.data;
        } else {
          // document.getElementById("command").innerHTML = msg.data;
          if (msg.data == "close")
            document.getElementById("OC-btn").innerText = "mở";
          else document.getElementById("OC-btn").innerText = "đóng";
        }
      };

      let cmo = {
        dv: "L",
        st: "open",
      };

      let cmc = {
        dv: "L",
        st: "close",
      };
      function buttonOnclick(event) {
        let state = event.target.innerText;
        if (state.toLowerCase() == "open") {
          connection.send(JSON.stringify(cmo));
        } else connection.send(JSON.stringify(cmc));
      }
    </script>
    <nav class="flex jC-fS aI-center nav-bar">
      <img class="flex jC-center" style="height:20px; margin-right: 10px;" src="/image/logo_knock_white.png" alt="">
      <% if(isAdmin){ %>
        <a href="/users/allusers" class="base-btn nav-btn">Quản lý</a>
        <% } %>
      <form action="/users/logout" method="POST">
        <button class="base-btn nav-btn" id="logout-btn" type="submit">Đăng xuất</button>
      </form>
    </nav>
    <p id="statedoor"></p>
    <button class="base-btn" id="OC-btn" onclick="buttonOnclick(event)">mở</button>
  </body>
</html>
